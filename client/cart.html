<!doctype html>
<html>
<head>
<meta charset="utf-8"><title>Cart - QB Jewellery</title>
<link rel="stylesheet" href="../assets/css/style.css"></head>
<body>
<div class="container">
    <header class="header">
        <a href="index.html" class="brand-link"><div class="brand">QB Jewellery</div></a>
        <div class="search-bar">
            <input id="q" class="input" placeholder="Search products...">
            <button class="search-icon-btn">üîç</button>
        </div>
        <nav class="main-nav">
            <a href="shop.html" class="nav-link">Shop</a>
            <a href="about.html" class="nav-link">About Us</a>
            <a href="wishlist.html" class="nav-link">Wishlist</a>
            <a href="cart.html" class="nav-link">Cart</a>
            <a href="profile.html" id="profile-link" class="nav-link">Profile</a>
        </nav>
    </header>
    <section>
        <h2>Your Cart</h2>
        <div id="cartlist"></div>
        <div style="margin-top:20px; text-align: right;">
            <button class="btn checkout-main-btn" onclick="checkout()">Checkout</button>
        </div>
    </section>
    <footer class="footer">QB Jewellery &copy; 2025</footer>
</div>
<script src="../assets/js/app.js"></script>
<script>
function updateHeaderLinks() {
    const role = getRole();
    const profileLink = document.getElementById('profile-link');
    
    if (profileLink) {
        if (role) {
            profileLink.href = 'profile.html';
            profileLink.textContent = 'Profile'; 
        } else {
            profileLink.href = 'login.html';
            profileLink.textContent = 'Login';
        }
    }
}

async function renderCart(){
    const prods = await loadInitialProducts();
    const cart = getCart();
    
    if(!cart.length){ 
        document.getElementById('cartlist').innerHTML='<p class="small">Your cart is empty. <a href="shop.html" style="color:var(--accent); text-decoration:underline;">Start Shopping</a></p>'; 
        const checkoutButton = document.querySelector('.checkout-main-btn');
        if (checkoutButton) checkoutButton.style.display = 'none';
        return; 
    }
    
    const lines = cart.map(ci=>{ 
        const p=prods.find(x=>x.id===ci.id); 
        const price = p ? p.price : 0;
        return `<div class="card"><div class="flex"><img src="${p.image}" class="cart-item-img"/><div style="flex:1; padding-left:15px;"><h4>${p.title}</h4><div class="small">Qty: ${ci.qty}</div></div><div><div class="badge">‚Çπ ${price * ci.qty}</div></div></div></div>`; 
    });
    
    document.getElementById('cartlist').innerHTML = lines.join('');
}

function checkout(){ 
    window.location.href = 'checkout.html'; 
}

updateHeaderLinks();
renderCart();
</script>
</body>
</html>